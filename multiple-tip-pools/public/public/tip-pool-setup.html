<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tip pool setup</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #fafbfc;
      margin: 0;
      color: #222;
    }
    .container {
      display: flex;
      min-height: 100vh;
    }
    .sidebar {
      width: 240px;
      background: #fff;
      border-right: 1px solid #e5e7eb;
      padding: 24px 0 0 0;
      display: flex;
      flex-direction: column;
    }
    .sidebar .nav-section {
      margin-bottom: 18px;
    }
    .sidebar .nav-title {
      font-size: 0.95rem;
      font-weight: 600;
      color: #222;
      margin: 0 0 10px 24px;
      letter-spacing: 0.5px;
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .sidebar li {
      margin-bottom: 2px;
    }
    .sidebar a {
      display: block;
      padding: 8px 24px;
      color: #222;
      text-decoration: none;
      border-radius: 6px 0 0 6px;
      font-size: 1rem;
      transition: background 0.15s;
    }
    .sidebar a.selected, .sidebar a:hover {
      background: #e6f0ff;
      color: #006aff;
      font-weight: 500;
    }
    .sidebar .sub-list {
      margin-left: 8px;
    }
    .sidebar .sub-list a {
      font-size: 0.97rem;
      padding-left: 36px;
    }
    .sidebar .sub-list a.selected {
      background: #e6f0ff;
      color: #006aff;
    }
    .sidebar-bottom {
      margin-top: auto;
      padding: 0 0 16px 0;
    }
    .sidebar-org {
      display: flex;
      align-items: center;
      padding: 16px 16px 0 16px;
      border-top: 1px solid #e5e7eb;
      margin-top: 16px;
    }
    .sidebar-org-icon {
      width: 36px;
      height: 36px;
      background: #e6f0ff;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      color: #006aff;
      font-size: 1.1rem;
      margin-right: 10px;
    }
    .sidebar-org-label {
      font-size: 1rem;
      color: #222;
      font-weight: 500;
    }
    .main-content {
      flex: 1;
      padding: 40px 40px 40px 40px;
      max-width: 1200px;
    }
    .header-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: #e6f0ff;
      color: #006aff;
      border-radius: 10px;
      width: 48px;
      height: 48px;
      font-size: 2rem;
      margin-right: 18px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    h1 {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 8px;
      margin-top: 0;
      display: flex;
      align-items: center;
    }
    .subheading {
      font-size: 1.08rem;
      color: #444;
      font-weight: 500;
      margin-bottom: 32px;
      margin-left: 66px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .subheading-icon {
      font-size: 1.3rem;
      color: #b6d4fe;
      background: #fff;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    }
    .custom-multiselect {
      min-width: 140px;
      padding: 6px 10px;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      font-size: 1rem;
      background: #fff;
      color: #222;
      position: relative;
      cursor: pointer;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 6px;
    }
    .custom-multiselect .chip {
      background: #e6f0ff;
      color: #006aff;
      border-radius: 12px;
      padding: 2px 10px 2px 8px;
      font-size: 0.97rem;
      display: flex;
      align-items: center;
      gap: 4px;
      margin-right: 2px;
    }
    .custom-multiselect .chip .remove-chip {
      font-size: 1.1em;
      color: #888;
      margin-left: 2px;
      cursor: pointer;
      border: none;
      background: none;
      padding: 0;
    }
    .custom-multiselect .placeholder {
      color: #bbb;
      font-size: 1rem;
      padding: 2px 0;
    }
    .custom-multiselect-dropdown {
      position: absolute;
      left: 0;
      top: 110%;
      z-index: 10;
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      min-width: 180px;
      padding: 8px 0;
      margin-top: 2px;
    }
    .custom-multiselect-dropdown label {
      display: flex;
      align-items: center;
      padding: 6px 18px 6px 12px;
      font-size: 1rem;
      cursor: pointer;
      gap: 8px;
    }
    .custom-multiselect-dropdown label:hover {
      background: #f6f8fa;
    }
  </style>
</head>
<body>
  <div class="container">
    <nav class="sidebar">
      <div class="nav-section">
        <ul>
          <li><a href="#">Team</a></li>
          <li><a href="#">Scheduling</a></li>
          <li><a href="#">Time tracking</a></li>
          <li><a href="#">Payroll</a></li>
          <li><a href="#">HR & compliance</a></li>
          <li><a href="#">Announcements</a></li>
          <li><a href="#">Reports</a></li>
        </ul>
      </div>
      <div class="nav-section">
        <div class="nav-title">Settings</div>
        <ul class="sub-list">
          <li><a href="#">Schedule</a></li>
          <li><a href="#">Time tracking</a></li>
          <li><a href="#">Labor & compliance</a></li>
          <li><a href="index.html" class="selected">Tip management</a></li>
          <li><a href="#">Commissions</a></li>
          <li><a href="#">Messages</a></li>
        </ul>
      </div>
      <div class="sidebar-bottom">
        <div class="sidebar-org">
          <div class="sidebar-org-icon">BC</div>
          <div class="sidebar-org-label">Birch Coffee</div>
        </div>
      </div>
    </nav>
    <main class="main-content">
      <div style="display: flex; justify-content: flex-end; align-items: center; margin-bottom: 8px;">
        <button id="next-btn" style="background: #006aff; color: #fff; border: none; border-radius: 6px; padding: 10px 28px; font-size: 1rem; font-weight: 500; cursor: pointer;">Next</button>
      </div>
      <h1><span class="header-icon">ðŸ’§</span>Tip pool setup</h1>
      <div style="margin-left: 66px; max-width: 500px;">
        <div style="font-size: 1.08rem; font-weight: 500; margin-bottom: 18px; color: #222;">Who/What contributes to the tip pool?</div>
        <form id="logic-builder-form" style="display: flex; flex-direction: column; gap: 18px;">
          <div id="logic-rows">
            <!-- Logic rows will be rendered here -->
          </div>
          <button id="add-row-btn" type="button" style="margin-top: 18px; align-self: flex-start; background: #006aff; color: #fff; border: none; border-radius: 6px; padding: 10px 24px; font-size: 1rem; font-weight: 500; cursor: pointer;">Add another</button>
        </form>
      </div>
    </main>
  </div>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Logic row template
    function createLogicRow() {
      const row = document.createElement('div');
      row.className = 'logic-row';
      row.style.display = 'flex';
      row.style.flexDirection = 'column';
      row.style.gap = '0';
      // Dropdown HTML
      const dropdownHTML = `
        <select style="width: 180px; padding: 10px 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 1rem; background: #fff; color: #222;">
          <option value="">Choose one</option>
          <optgroup label="Device">
            <option value="Device 1">Device 1</option>
            <option value="Device 2">Device 2</option>
            <option value="Device 3">Device 3</option>
          </optgroup>
          <optgroup label="Mode">
            <option value="Mode 1">Mode 1</option>
            <option value="Mode 2">Mode 2</option>
            <option value="Mode 3">Mode 3</option>
          </optgroup>
          <optgroup label="Section">
            <option value="Section 1">Section 1</option>
            <option value="Section 2">Section 2</option>
            <option value="Section 3">Section 3</option>
          </optgroup>
          <optgroup label="Channel">
            <option value="Channel 1">Channel 1</option>
            <option value="Channel 2">Channel 2</option>
            <option value="Channel 3">Channel 3</option>
          </optgroup>
          <optgroup label="Order Source">
            <option value="Order Source 1">Order Source 1</option>
            <option value="Order Source 2">Order Source 2</option>
            <option value="Order Source 3">Order Source 3</option>
          </optgroup>
        </select>
      `;
      // Helper to create a dropdown+CTAs+chain
      function createDropdownChain() {
        const container = document.createElement('div');
        container.style.display = 'flex';
        container.style.alignItems = 'center';
        container.style.gap = '12px';
        // Dropdown
        const dropdownDiv = document.createElement('div');
        dropdownDiv.innerHTML = dropdownHTML;
        container.appendChild(dropdownDiv.firstElementChild);
        // +AND and +OR CTAs
        const andBtn = document.createElement('button');
        andBtn.textContent = '+AND';
        andBtn.type = 'button';
        andBtn.style.marginLeft = '8px';
        andBtn.style.background = '#fff';
        andBtn.style.color = '#006aff';
        andBtn.style.border = '1px solid #006aff';
        andBtn.style.borderRadius = '6px';
        andBtn.style.padding = '4px 14px';
        andBtn.style.fontSize = '0.98rem';
        andBtn.style.fontWeight = '500';
        andBtn.style.cursor = 'pointer';
        andBtn.style.transition = 'background 0.15s, color 0.15s';
        const orBtn = document.createElement('button');
        orBtn.textContent = '+OR';
        orBtn.type = 'button';
        orBtn.style.marginLeft = '6px';
        orBtn.style.background = '#fff';
        orBtn.style.color = '#006aff';
        orBtn.style.border = '1px solid #006aff';
        orBtn.style.borderRadius = '6px';
        orBtn.style.padding = '4px 14px';
        orBtn.style.fontSize = '0.98rem';
        orBtn.style.fontWeight = '500';
        orBtn.style.cursor = 'pointer';
        orBtn.style.transition = 'background 0.15s, color 0.15s';
        container.appendChild(andBtn);
        container.appendChild(orBtn);
        // AND/OR logic
        let andOrLabel = null;
        let nextDropdown = null;
        function addAndOr(type) {
          andBtn.style.display = 'none';
          orBtn.style.display = 'none';
          // AND/OR label
          andOrLabel = document.createElement('span');
          andOrLabel.textContent = type;
          andOrLabel.style.margin = '0 8px';
          andOrLabel.style.fontWeight = '600';
          andOrLabel.style.color = '#888';
          container.appendChild(andOrLabel);
          // Add next dropdown+CTAs recursively
          nextDropdown = createDropdownChain();
          container.appendChild(nextDropdown);
        }
        andBtn.onclick = () => addAndOr('AND');
        orBtn.onclick = () => addAndOr('OR');
        return container;
      }
      // First line: dropdown chain
      const dropdownChain = createDropdownChain();
      // Second line: indented logic
      const logicDiv = document.createElement('div');
      logicDiv.style.display = 'flex';
      logicDiv.style.alignItems = 'center';
      logicDiv.style.gap = '16px';
      logicDiv.style.marginLeft = '32px';
      logicDiv.style.marginTop = '6px';
      logicDiv.innerHTML = `
        <span style="font-size: 1rem; color: #222;">contributes</span>
        <span style="display: flex; align-items: center; gap: 4px;">
          <input type="number" min="0" max="100" placeholder="0" style="width: 60px; padding: 10px 8px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: 1rem; text-align: right; appearance: textfield;" />
          <span style="font-size: 1rem; color: #222;">%</span>
        </span>
        <span style="font-size: 1rem; color: #222;">of</span>
        <div style="display: flex; gap: 32px; align-items: center;">
          <label style="display: flex; align-items: center; gap: 6px; font-size: 1rem; cursor: pointer; min-width: 130px; white-space: nowrap;">
            <input type="checkbox" name="tip-type" value="cash tips" style="accent-color: #006aff; width: 16px; height: 16px;"> Cash tips
          </label>
          <label style="display: flex; align-items: center; gap: 6px; font-size: 1rem; cursor: pointer; min-width: 150px; white-space: nowrap;">
            <input type="checkbox" name="tip-type" value="non-cash tips" style="accent-color: #006aff; width: 16px; height: 16px;"> Non-cash tips
          </label>
          <label style="display: flex; align-items: center; gap: 6px; font-size: 1rem; cursor: pointer; min-width: 150px; white-space: nowrap;">
            <input type="checkbox" name="tip-type" value="auto gratuities" style="accent-color: #006aff; width: 16px; height: 16px;"> Auto gratuities
          </label>
        </div>
      `;
      row.appendChild(dropdownChain);
      row.appendChild(logicDiv);
      return row;
    }
    function createOrToggle(initial = 'OR') {
      const orDiv = document.createElement('div');
      orDiv.textContent = initial;
      orDiv.style.textAlign = 'center';
      orDiv.style.fontWeight = '600';
      orDiv.style.color = '#888';
      orDiv.style.margin = '8px 0 8px 0';
      orDiv.style.cursor = 'pointer';
      orDiv.tabIndex = 0;
      orDiv.setAttribute('role', 'button');
      orDiv.setAttribute('aria-label', 'Toggle AND/OR');
      orDiv.onclick = function() {
        orDiv.textContent = orDiv.textContent === 'OR' ? 'AND' : 'OR';
      };
      orDiv.onkeydown = function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          orDiv.click();
        }
      };
      return orDiv;
    }
    const logicRowsContainer = document.getElementById('logic-rows');
    function renderInitialRows() {
      logicRowsContainer.innerHTML = '';
      logicRowsContainer.appendChild(createLogicRow());
    }
    renderInitialRows();
    document.getElementById('add-row-btn').onclick = function() {
      logicRowsContainer.appendChild(createLogicRow());
    };
    // Next button navigation
    document.getElementById('next-btn').onclick = function() {
      // Gather contributors with dropdown chains
      function getDropdownChain(container) {
        const chain = [];
        let node = container;
        while (node) {
          const select = node.querySelector('select');
          let value = select ? select.value : '';
          let andOr = null;
          // Find AND/OR label if present
          const siblings = Array.from(node.childNodes);
          for (let sib of siblings) {
            if (sib.nodeType === 1 && sib.tagName === 'SPAN' && (sib.textContent === 'AND' || sib.textContent === 'OR')) {
              andOr = sib.textContent;
            }
          }
          chain.push({ value, andOr });
          // Find next dropdown chain (if any)
          const next = Array.from(node.childNodes).find(
            el => el.nodeType === 1 && el.querySelector && el.querySelector('select') && el !== node.firstElementChild
          );
          node = next;
        }
        return chain;
      }
      const rows = Array.from(document.querySelectorAll('.logic-row'));
      const contributors = rows.map(row => {
        const dropdownChain = getDropdownChain(row.firstElementChild);
        const percent = row.querySelector('input[type="number"]')?.value || '';
        const tipTypes = Array.from(row.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
        return { dropdownChain, percent, tipTypes };
      }).filter(c => c.dropdownChain.some(d => d.value) || c.percent || c.tipTypes.length);
      localStorage.setItem('tipPoolContributors', JSON.stringify(contributors));
      window.location.href = 'tip-pool-review.html';
    };
  });
  </script>
</body>
</html> 